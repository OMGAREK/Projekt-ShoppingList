<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
 xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
 xmlns:viewmodel="clr-namespace:ShoppingListAW4E.ViewModels"
 xmlns:views="clr-namespace:ShoppingListAW4E.Views"
 x:Class="ShoppingListAW4E.Views.CombinedPage"
 Title="Categories and Products">

 <ContentPage.BindingContext>
 <viewmodel:CombinedViewModel />
 </ContentPage.BindingContext>

 <ScrollView>
 <VerticalStackLayout Padding="20" Spacing="10">

 <Frame>
 <VerticalStackLayout Spacing="8">
 <Label Text="Add category" FontAttributes="Bold" />
 <Entry Placeholder="New category" Text="{Binding NewCategoryName}" />
 <Button Text="Add category" Clicked="OnAddCategoryClicked" />
 </VerticalStackLayout>
 </Frame>

 <Frame>
 <VerticalStackLayout Spacing="8">
 <Label Text="Add product" FontAttributes="Bold" />
 <Entry Placeholder="Product name" Text="{Binding NewProductName}" />
 <Entry Placeholder="Quantity" Keyboard="Numeric" Text="{Binding NewProductQuantity}" />
 <Entry Placeholder="Unit" Text="{Binding NewProductUnit}" />
 <Picker Title="Category"
 ItemsSource="{Binding Categories}"
 ItemDisplayBinding="{Binding Name}"
 SelectedItem="{Binding SelectedCategory}" />
 <Button Text="Add product" Clicked="OnAddProductClicked" />
 </VerticalStackLayout>
 </Frame>

 <CollectionView ItemsSource="{Binding Categories}">
 <CollectionView.ItemTemplate>
 <DataTemplate>
 <VerticalStackLayout>
 <Grid ColumnDefinitions="*,Auto">
 <Button Text="{Binding Name}" Clicked="OnCategoryClicked" HorizontalOptions="StartAndExpand" />
 <Button Text="Delete" TextColor="Red" Clicked="OnRemoveCategoryClicked" Grid.Column="1" />
 </Grid>

 <CollectionView ItemsSource="{Binding Products}" IsVisible="{Binding IsExpanded}">
 <CollectionView.ItemTemplate>
 <DataTemplate>
 <views:ProductView />
 </DataTemplate>
 </CollectionView.ItemTemplate>
 </CollectionView>
 </VerticalStackLayout>
 </DataTemplate>
 </CollectionView.ItemTemplate>
 </CollectionView>

 </VerticalStackLayout>
 </ScrollView>
</ContentPage>