using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Runtime.CompilerServices;

namespace ShoppingListAW4E.Models
{
    // KLASA: Category
    // Ta klasa reprezentuje jedną kategorię produktów, np. "Owoce".
    // Poniżej dodajemy komentowane linijki opisujące każdy element klasy,
    // tak aby osoba bez doświadczenia programistycznego rozumiała co się dzieje.
    public class Category : INotifyPropertyChanged
    {
        // Prywatne pole przechowujące nazwę kategorii.
        // Pole to nie jest bezpośrednio widoczne poza klasą; używamy właściwości Name
        // aby bezpiecznie odczytywać i zapisywać tę wartość.
        string name;

        // Prywatne pole przechowujące informację, czy kategoria jest rozwinięta (widoczna lista produktów).
        bool isExpanded;

        // WŁAŚCIWOŚĆ: Name
        // public string Name { get; set; } ale z dodatkową obsługą powiadamiania o zmianie.
        // - get zwraca bieżącą wartość pola name.
        // - set zapisuje nową wartość do pola name i powiadamia system, że wartość się zmieniła.
        // Powiadomienie jest potrzebne, aby interfejs użytkownika mógł automatycznie
        // odświeżyć wyświetlaną nazwę bez ręcznego przeładowania ekranu.
        public string Name
        {
            get => name; // zwróć aktualną nazwę
            set
            {
                name = value; // zapisz nową nazwę
                OnPropertyChanged(); // poinformuj system, że właściwość się zmieniła
            }
        }

        // WŁAŚCIWOŚĆ: IsExpanded
        // - Kontroluje czy lista produktów w tej kategorii jest widoczna (true) czy zwinięta (false).
        // - Po ustawieniu nowej wartości wywołujemy OnPropertyChanged, aby UI mógł się odświeżyć.
        public bool IsExpanded
        {
            get => isExpanded; // zwróć, czy kategoria jest rozwinięta
            set
            {
                isExpanded = value; // zapisz nowy stan
                OnPropertyChanged(); // powiadom widok o zmianie
            }
        }

        // LISTA PRODUKTÓW W KATEGORII
        // ObservableCollection to specjalna lista, która sama powiadamia interfejs
        // gdy dodajemy lub usuwamy elementy — dlatego UI automatycznie się zaktualizuje.
        public ObservableCollection<Product> Products { get; set; } = new();

        // KONSTRUKTOR: tworzy nową kategorię z podaną nazwą.
        // - Kiedy ktoś tworzy nowy obiekt Category, musi podać nazwę.
        // - Konstruktor ustawia właściwość Name, co spowoduje również wywołanie
        // OnPropertyChanged (ale w konstruktorze UI jeszcze nie może reagować).
        public Category(string name)
        {
            Name = name; // przypisz nazwę do właściwości
        }

        // WYDARZENIE: PropertyChanged
        // - To mechanizm (z interfejsu INotifyPropertyChanged), który pozwala klasie
        // poinformować innych (np. elementy interfejsu), że jakaś właściwość się zmieniła.
        // - Inne części programu subskrybują (słuchają) tego wydarzenia i odświeżają się
        // automatycznie, gdy jest wywołane.
        public event PropertyChangedEventHandler PropertyChanged;

        // METODA: OnPropertyChanged
        // - Wywołujemy tę metodę zawsze, gdy chcemy poinformować system o zmianie właściwości.
        // - Parametr name domyślnie jest ustawiany automatycznie na nazwę wywołującej właściwości
        // dzięki atrybutowi [CallerMemberName], więc zwykle nie musimy podawać nazwy ręcznie.
        void OnPropertyChanged([CallerMemberName] string name = "")
        {
            // Jeśli ktoś subskrybuje wydarzenie PropertyChanged, wywołujemy je
            // przekazując nazwę właściwości, która się zmieniła.
            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(name));
        }
    }
}